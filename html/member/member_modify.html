<!DOCTYPE html>
<html class="ui-page-login">

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<link href="../../css/style.css" rel="stylesheet" />
		<style>
			.mui-input-row {
				width: 90%;
				margin: 10px auto;
				margin-top: 40px;
				color: #fff;
				text-align: center;
			}
			
			.mui-input-row input {
				background-color: transparent;
				border: 1px solid #fff;
				color: #000;
				text-align: left;
				padding-left: 5px;
				height: 40px;
				border: none;
				border-bottom: 1px solid #8F8F94;
				-webkit-border-radius: 0px;
				border-radius: 0px;
			}
			
			.mui-input-row {
				position: relative;
			}
			
			.mui-input-row .yz_img {
				position: absolute;
				z-index: 2;
				top: 10px;
				right: 0px;
				width: 70px;
				height: 30px;
			}
			
			.mui-input-row .yz_img img {
				width: 100%;
				height: 100%;
			}
			
			.mui-input-row .input_name {
				position: absolute;
				z-index: 2;
				top: 15px;
				left: 5px;
				height: 30px;
				color: #ababab;
				text-align: left;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">修改个人信息</h1>
		</header>
		<div class="mui-content">
			<form>
				<div class="mui-input-row">
					<input id='account' type="text" class="mui-input-clear " placeholder="请输入需要修改的个人信息">
				</div>
				<!--<div class="mui-input-row">
					<label>密码</label>
					<input id='password' type="password" class="mui-input-clear mui-input" placeholder="请输入密码">
				</div>
				<div class="mui-input-row">
					<label>确认</label>
					<input id='password_confirm' type="password" class="mui-input-clear mui-input" placeholder="请确认密码">
				</div>
				<div class="mui-input-row">
					<label>邮箱</label>
					<input id='email' type="email" class="mui-input-clear mui-input" placeholder="请输入邮箱">
				</div>-->
			</form>
			<div class="mui-content-padded">
				<button id='btnsave' class="mui-btn mui-btn-block mui-btn-primary">完成</button>
			</div>
		</div>
		<script src="../../js/mui.min.js"></script>
		<script src="../../js/app.js"></script>
		<script src="../../js/localDatabase.js"></script>
		<script src="../../js/post.js"></script>
		<script src="../../js/dao.js"></script>
		<script src="../../js/member.js"></script>
		<script>
			mui.init();
			var member = new Member();
			var _dataAccess = new DataAccess();
			var _self;
			var field;
			var fieldValue;
			mui.plusReady(function() {
				_self = plus.webview.currentWebview();
				field = _self.field;
				fieldValue = _self.fieldValue;
				var btnsave = document.getElementById('btnsave');
				var accountBox = document.getElementById('account');
				accountBox.placeholder = _self.title;
				accountBox.value = fieldValue;
				btnsave.addEventListener('tap', function(event) {
					if(accountBox.value == '') {
						mui.toast('请输入正确信息');
						return;
					}
					member.UpdateField(field, accountBox.value, function(result) {
						console.log(JSON.stringify(result));
						if(result.status == 1||result.type==1) {
							plus.nativeUI.showWaiting();
							var user = _dataAccess.getUser();
							user.field = fieldValue;
							_dataAccess.setUser(user);
							console.log(JSON.stringify(_dataAccess.getUser()));
							plus.nativeUI.closeWaiting();
							var person = plus.webview.getWebviewById('person_center.html');
							mui.fire(person, 'Refresh');
							mui.back();
						} else {
							mui.toast(result.message);
						}

					}, function() {
						mui.toast('操作异常，请确认格式正确');
					})
				});
				//				var Search = function() {
				//					var translatematrixREa = /^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/;
				//					var matrix = translatematrixREa.test(accountBox.value);
				//					//如果手机号码不能通过验证
				//					if(matrix == true) {
				//						mui.openWindow({
				//							url: 'reg_step2.html',
				//							id: 'reg_step2.html',
				//							show: {
				//								aniShow: 'pop-in'
				//							},
				//							extras:{
				//								data:accountBox.value
				//							}
				//						});
				//					} else {
				//						mui.alert("手机号码格式错误");
				//					}
				//				}
			})
		</script>
	</body>

</html>